<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Organization">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta itemprop="name" content="Pulsar">
<meta itemprop="description" content="Erlang-like actors for Clojure">
<title>
  
    Clustering - 
   Pulsar
</title>
<!--<link rel="shortcut icon" href="/images/icons/loading_icon.png">-->
<link href="/pulsar/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/pulsar/css/coderay.css" rel="stylesheet" type="text/css">
<!-- <link href="/pulsar/css/prettify/sunburst.css" rel="stylesheet" type="text/css"> -->
<!-- <link href="/css/pygments/default.css" rel="stylesheet" type="text/css"> -->
<link href="/pulsar/css/site.css?now" rel="stylesheet" type="text/css">



</head>
<body>

<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container-fluid">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
      </a>
      <a class="brand" href="/pulsar/">Pulsar</a>
      <div class="nav-collapse collapse">
        <ul class="nav">
          <li class="icon github"><a href="https://github.com/puniverse/pulsar"><img src="/pulsar/images/icons/github.png">View on Github</a></li>
          <li><a href="/pulsar/api/index.html">API</a> </li>
          <li class="icon bug"><a href="https://github.com/puniverse/pulsar/issues/new"><img src="/pulsar/images/icons/bug.png">File a bug</a></li>
          <!-- <li class="icon source"><a href="https://github.com/puniverse/pulsar/blob/master/CONTRIBUTING.md"><img src="/images/icons/source.png">Contribute</a> </li> -->
          <li class="icon talk"><a href="https://groups.google.com/forum/#!forum/quasar-pulsar-user"><img src="/pulsar/images/icons/talk.png">Discuss</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>


<div class="container-fluid">
  <div class="row-fluid">
    <div class="span3">
  <div class="well well-small sidebar-nav">
    <ul class="nav nav-list">
      
        <li class="nav-header">Getting Started</li>
        
          
          
            
          
          
          
            <li>
              <a  href="/pulsar/getting-started.html">
                Getting Started
              </a>
              
            </li>
          
        
          
          
            
          
          
          
        
          
          
            
          
          
          
        
          
          
            
          
          
          
        
          
          
            
          
          
          
        
          
          
            
          
          
          
        
          
          
            
          
          
          
            <li>
              <a  href="/pulsar/news.html">
                News
              </a>
              
            </li>
          
        
      
        <li class="nav-header">User Manual</li>
        
          
          
            
          
          
          
        
          
          
            
          
          
          
            <li>
              <a  href="/pulsar/manual/core.html">
                Pulsar Core
              </a>
              
            </li>
          
        
          
          
            
          
          
          
            <li>
              <a  href="/pulsar/manual/actors.html">
                Pulsar's Actor System
              </a>
              
            </li>
          
        
          
          
            
          
          
          
            <li>
              <a  href="/pulsar/manual/async.html">
                core.async
              </a>
              
            </li>
          
        
          
          
            
          
          
          
            <li>
              <a class="active" href="/pulsar/manual/cluster.html">
                Clustering
              </a>
              
              <ul class="nav nav-list"><li><a href="#enabling-clustering">Enabling Clustering</a></li><li><a href="#example">Example</a></li><li><a href="#cluster-configuration">Cluster Configuration</a></li></ul>
              
            </li>
          
        
          
          
            
          
          
          
            <li>
              <a  href="/pulsar/manual/examples.html">
                Examples
              </a>
              
            </li>
          
        
          
          
            
          
          
          
        
      
      <li class="divider"></li>
    </ul>
  </div>
</div>

    <div class="span8" id="content-container">

      <span class="edit-on-github">
  <a href="https://github.com/puniverse/pulsar/edit/master/docs/manual/cluster.md">Edit on Github</a>
</span>


      
      <div class="page-header">
        <h1>Clustering
          
        </h1>
      </div>
      

      <div id="content">
<p>Pulsar is able to run on a cluster, thereby letting actors and channels communicate across machines. The Pulsar/Quasar cluster runs on top of <a href="http://puniverse.github.io/galaxy/">Galaxy</a>, Parallel Universe&#8217;s in-memory data grid. </p>

<p>In this version, clustering is pretty rudimentary, but essential features should work: actors can be made discoverable on the network, messages can be passed among actors on different nodes, and an actor on a failing node will behave as expected of a dying actor with respect to exit messages sent to other, remote, <em>watching</em> it or <em>linked</em> to it.</p>

<h2 id="enabling-clustering">Enabling Clustering</h2>

<p>First, you will need to add <code>quasar-galaxy</code> as a dependency to your project:</p>

<div><div class="CodeRay">
  <div class="code"><pre>[co.paralleluniverse/quasar-galaxy <span class="string"><span class="delimiter">&quot;</span><span class="content">0.2</span><span class="delimiter">&quot;</span></span>]
</pre></div>
</div>
</div>

<p>To make an actor discoverable, all you need to do is register it:</p>

<div><div class="CodeRay">
  <div class="code"><pre>(register actor <span class="symbol">:global-actor1</span>)
</pre></div>
</div>
</div>

<p>or, if the actor already has a name (set in <code>spawn</code>), simply call:</p>

<div><div class="CodeRay">
  <div class="code"><pre>(register)
</pre></div>
</div>
</div>

<p>That&#8217;s it. The actor is now known throughout the cluster. If you want to send a message to it, call</p>

<div><div class="CodeRay">
  <div class="code"><pre>(! <span class="symbol">:global-actor1</span> [<span class="symbol">:hi-from</span> @self])
</pre></div>
</div>
</div>

<p>Though this call looks up the actor in the registry every time it&#8217;s called. A better way might be:</p>

<div><div class="CodeRay">
  <div class="code"><pre>(<span class="keyword">let</span> [a (whereis <span class="symbol">:global-actor1</span>)]
   (! a [<span class="symbol">:hi-from</span> @self]))
</pre></div>
</div>
</div>

<p>An actor doesn&#8217;t have to be registered in order to be reachable on the network. Registering it simply makes it <em>discoverable</em>. If we pass a local actor in a message to a remote actor, the remote actor will be able to send messages to the local actor as well. In the simple example above, we are sending @self to :global-actor1; :global-actor1 will be able to send messages back to us.</p>

<h2 id="example">Example</h2>

<p>The best way to get started is by running the distributed pingpong example.</p>

<p>Here&#8217;s the code for <a href="(https://github.com/puniverse/pulsar/tree/master/src/test/clojure/co/paralleluniverse/pulsar/examples/cluster/ping.clj)">ping</a> and for <a href="(https://github.com/puniverse/pulsar/tree/master/src/test/clojure/co/paralleluniverse/pulsar/examples/cluster/pong.clj)">pong</a>. You run them like this:</p>

<div><div class="CodeRay">
  <div class="code"><pre>lein with-profile cluster update-in :jvm-opts conj '&quot;-Dgalaxy.nodeId=2&quot;' '&quot;-Dgalaxy.port=7052&quot;' '&quot;-Dgalaxy.slave_port=8052&quot;' -- run -m co.paralleluniverse.pulsar.examples.cluster.ping
lein with-profile cluster update-in :jvm-opts conj '&quot;-Dgalaxy.nodeId=1&quot;' '&quot;-Dgalaxy.port=7051&quot;' '&quot;-Dgalaxy.slave_port=8051&quot;' -- run -m co.paralleluniverse.pulsar.examples.cluster.pong
</pre></div>
</div>
</div>

<h2 id="cluster-configuration">Cluster Configuration</h2>

<p>For instructions on how to configure the Galaxy cluster, please refere to Galaxy&#8217;s <a href="http://puniverse.github.io/galaxy/start/getting-started.html">getting started guide</a>.</p>

</div>

      <hr>

      <footer>
        <div>
          <div>&copy; 2013, Parallel Universe Software Co.</div>
        </div>
      </footer>

    </div>
  </div>
</div>

<!-- <script src="/pulsar/js/prettify/prettify.js"></script> -->
<script src="/pulsar/js/jquery.min.js"></script>
<script src="/pulsar/bootstrap/js/bootstrap.min.js"></script>
<script src="/pulsar/js/bootstrap-scrollspy.js"></script>
<script>


  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-25007319-2']);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); 
    ga.type = 'text/javascript'; 
    ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; 
    s.parentNode.insertBefore(ga, s);
  })();


// Change "active" style on selected left-hand navigation menu item.
$(document).ready(function () {
  var path = location.pathname;
  $('ul.nav > li > a[href="' + path + '"]').parent().addClass('active');

  // TODO: Use kramdown {:.prettyprint .linenums .lang-ruby} to add the
  // <pre class="prettyprint"> instead of doing this client-side.

  // $('pre:has(code:not(.language-txt))').addClass('prettyprint');
  // window.prettyPrint && prettyPrint();
});
</script>

</body>
</html>
